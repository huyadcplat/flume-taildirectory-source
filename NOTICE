Based on the work of https://github.com/jinoos/flume-ng-extends
